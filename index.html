<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Testing</title>
  <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-functions.js"></script>
</head>
<body>
  <h1>Testing</h1>
  <button onclick="pingServer()">Ping Server</button>
  <p id="response"></p>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDhuc1LsStEPg-ksXXgnflQ2tu0dl5syHA",
      authDomain: "classicalmath.firebaseapp.com",
      projectId: "classicalmath",
      storageBucket: "classicalmath.firebasestorage.app",
      messagingSenderId: "115442672639",
      appId: "1:115442672639:web:ffd3308688abfcc5d63dca",
      measurementId: "G-05K9M3VQTK"
    };

    // Initialize Firebase if we're on the production site
    if (window.location.hostname === 'classicalmath.org') {
      firebase.initializeApp(firebaseConfig);
    }

    async function pingServer() {
      const responseElement = document.getElementById('response');
      try {
        let response;
        if (window.location.hostname === 'classicalmath.org') {
          // Use Firebase Functions for production
          const functions = firebase.functions();
          const pingFunction = functions.httpsCallable('ping');
          const result = await pingFunction();
          responseElement.textContent = `Response: ${result.data.message || result.data}`;
        } else {
          // Use fetch for local development
          response = await fetch('http://localhost:5001/classicalmath/us-central1/ping');
          const data = await response.text(); // <-- changed from json() to text()
          responseElement.textContent = `Response: ${data}`;
        }
      } catch (error) {
        responseElement.textContent = `Error: ${error.message}`;
      }
    }  </script>
</body>
</html>
